{% extends "base.html" %}

{% block title %}Book an Appointment - Dr. Guli Bekmurodovna{% endblock %}

{% block content %}

<!-- PAGE HERO (short modern band) -->
<section class="page-hero d-flex align-items-center">
  <div class="page-hero-overlay"></div>
  <div class="container position-relative">
    <div class="row">
      <div class="col-lg-8">
        <div class="page-hero-content reveal-on-scroll">
          <p class="section-label mb-2">
            <span class="page-text">appointment_title</span>
          </p>
          <h1 class="h2 h1-lg fw-semibold mb-3">
            <span class="page-text">intro</span>
          </h1>
          <p class="text-muted mb-0">
            <span class="page-text">note</span>
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- BOOKING FORM SECTION -->
<section class="py-5 section-soft">
  <div class="container">
    <div class="row g-4 align-items-start booking-layout">
      {% set form = request.form %}

      <!-- FORM COLUMN -->
      <div class="col-lg-7">
        <div class="booking-card p-4 p-lg-5 reveal-on-scroll">
          <h2 class="h4 fw-semibold mb-3">
            Appointment details
          </h2>
          <p class="text-muted small mb-4">
            Please fill in your contact information and choose a day and time for your session.
          </p>

          <form
            method="POST"
            action="{{ url_for('appointment', lang=lang) }}"
            novalidate
            autocomplete="on"
          >
            {# If you use Flask-WTF, you can add: {{ form.hidden_tag() }} #}

            <div class="row g-3">
              <!-- Full name (backend: name) -->
              <div class="col-md-6">
                <label for="name" class="form-label tiny text-uppercase letter-spacing-wide">
                  Full name
                </label>
                <input
                  type="text"
                  class="form-control"
                  id="name"
                  name="name"
                  required
                  aria-required="true"
                  autocomplete="name"
                  value="{{ form.get('name', '') }}"
                  placeholder="Enter your full name"
                >
              </div>

              <!-- Email (backend: email) -->
              <div class="col-md-6">
                <label for="email" class="form-label tiny text-uppercase letter-spacing-wide">
                  Email
                </label>
                <input
                  type="email"
                  class="form-control"
                  id="email"
                  name="email"
                  required
                  aria-required="true"
                  autocomplete="email"
                  value="{{ form.get('email', '') }}"
                  placeholder="you@example.com"
                >
              </div>

              <!-- Phone (backend: phone) -->
              <div class="col-md-6">
                <label for="phone" class="form-label tiny text-uppercase letter-spacing-wide">
                  Phone number
                </label>
                <input
                  type="tel"
                  class="form-control"
                  id="phone"
                  name="phone"
                  required
                  aria-required="true"
                  autocomplete="tel"
                  value="{{ form.get('phone', '') }}"
                  placeholder="+998 ..."
                >
              </div>

              <!-- Date (backend: date) -->
              <div class="col-md-3">
                <label for="date" class="form-label tiny text-uppercase letter-spacing-wide">
                  Preferred date
                </label>
                <input
                  type="date"
                  class="form-control"
                  id="date"
                  name="date"
                  required
                  aria-required="true"
                  value="{{ form.get('date', '') }}"
                >
              </div>

              <!-- Time (backend: time) -->
              <div class="col-md-3">
                <label for="time" class="form-label tiny text-uppercase letter-spacing-wide">
                  Time
                </label>
                {% set selected_time = form.get('time', '') %}
                <select
                  class="form-select"
                  id="time"
                  name="time"
                  required
                  aria-required="true"
                >
                  <option value="">Select</option>
                  <option value="09:00" {{ 'selected' if selected_time == '09:00' else '' }}>09:00</option>
                  <option value="10:00" {{ 'selected' if selected_time == '10:00' else '' }}>10:00</option>
                  <option value="11:00" {{ 'selected' if selected_time == '11:00' else '' }}>11:00</option>
                  <option value="12:00" {{ 'selected' if selected_time == '12:00' else '' }}>12:00</option>
                  <option value="14:00" {{ 'selected' if selected_time == '14:00' else '' }}>14:00</option>
                  <option value="15:00" {{ 'selected' if selected_time == '15:00' else '' }}>15:00</option>
                  <option value="16:00" {{ 'selected' if selected_time == '16:00' else '' }}>16:00</option>
                  <option value="17:00" {{ 'selected' if selected_time == '17:00' else '' }}>17:00</option>
                  <option value="18:00" {{ 'selected' if selected_time == '18:00' else '' }}>18:00</option>
                </select>
              </div>

              <!-- Optional: Session type (NOT required by backend) -->
              <div class="col-md-6">
                <label for="session_type" class="form-label tiny text-uppercase letter-spacing-wide">
                  Session type (optional)
                </label>
                {% set selected_type = form.get('session_type', '') %}
                <select
                  class="form-select"
                  id="session_type"
                  name="session_type"
                >
                  <option value="" {{ 'selected' if not selected_type else '' }}>No preference</option>
                  <option value="online" {{ 'selected' if selected_type == 'online' else '' }}>Online</option>
                  <option value="in_person" {{ 'selected' if selected_type == 'in_person' else '' }}>In person</option>
                  <option value="hybrid" {{ 'selected' if selected_type == 'hybrid' else '' }}>Flexible / hybrid</option>
                </select>
              </div>

              <!-- Optional: Topic -->
              <div class="col-md-6">
                <label for="topic" class="form-label tiny text-uppercase letter-spacing-wide">
                  Focus of the session (optional)
                </label>
                {% set selected_topic = form.get('topic', '') %}
                <select
                  class="form-select"
                  id="topic"
                  name="topic"
                >
                  <option value="" {{ 'selected' if not selected_topic else '' }}>Choose a topic (optional)</option>
                  <option value="stress" {{ 'selected' if selected_topic == 'stress' else '' }}>Stress &amp; burnout</option>
                  <option value="relationships" {{ 'selected' if selected_topic == 'relationships' else '' }}>Relationships</option>
                  <option value="anxiety" {{ 'selected' if selected_topic == 'anxiety' else '' }}>Anxiety &amp; worry</option>
                  <option value="self_esteem" {{ 'selected' if selected_topic == 'self_esteem' else '' }}>Self-esteem</option>
                  <option value="other" {{ 'selected' if selected_topic == 'other' else '' }}>Other / not sure</option>
                </select>
              </div>

              <!-- Message (optional) -->
              <div class="col-12">
                <label for="message" class="form-label tiny text-uppercase letter-spacing-wide">
                  Short message (optional)
                </label>
                <textarea
                  class="form-control"
                  id="message"
                  name="message"
                  rows="4"
                  placeholder="You can briefly describe what you’re going through or what you expect from therapy."
                >{{ form.get('message', '') }}</textarea>
              </div>

              <!-- Info note -->
              <div class="col-12">
                <div class="alert alert-info mt-2 tiny">
                  <i class="fas fa-info-circle me-2" aria-hidden="true"></i>
                  <span class="alert-text">This form is not monitored 24/7 and cannot be used for emergencies.</span>
                </div>
              </div>

              <!-- Submit -->
              <div class="col-12 pt-2">
                <button
                  type="submit"
                  class="btn btn-primary btn-lg px-5 w-100"
                >
                  <i class="fas fa-calendar-check me-2" aria-hidden="true"></i>
                  Request appointment
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>

      <!-- SIDE INFO PANEL -->
      <div class="col-lg-5">
        <div class="booking-info-card p-4 p-lg-5 reveal-on-scroll">
          <h3 class="h5 fw-semibold mb-3">
            Practical information
          </h3>

          <div class="mb-3">
            <p class="fw-semibold mb-1 small text-uppercase letter-spacing-wide">
              Availability
            </p>
            <p class="mb-0 text-muted tiny">
              Mon – Fri · 09:00 – 18:00  
              <br>Some evening sessions are available upon request.
            </p>
          </div>

          <div class="mb-3">
            <p class="fw-semibold mb-1 small text-uppercase letter-spacing-wide">
              Location
            </p>
            <p class="mb-0 text-muted tiny">
              Studio in Tashkent (add exact address)  
              <br>Online sessions via Zoom / Google Meet.
            </p>
          </div>

          <div class="mb-3">
            <p class="fw-semibold mb-1 small text-uppercase letter-spacing-wide">
              Languages
            </p>
            <p class="mb-0 text-muted tiny">
              Uzbek · Russian 
            </p>
          </div>

          <div class="booking-note mt-4 pt-3">
            <p class="tiny text-muted mb-1">
              Please note
            </p>
            <p class="mb-0 tiny text-muted">
              If you don’t receive a confirmation within a reasonable time, please check your spam folder
              or contact the studio directly by phone.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Min date script (tomorrow onwards) -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const dateInput = document.getElementById('date');
    if (dateInput && !dateInput.value) {
      const today = new Date();
      today.setDate(today.getDate() + 1); // tomorrow
      const tomorrow = today.toISOString().split('T')[0];
      dateInput.setAttribute('min', tomorrow);
    }
  });
</script>

{% endblock %}
