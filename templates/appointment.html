{% extends "base.html" %}

{% block title %}Book an Appointment - Dr. Guli Bekmurodovna{% endblock %}

{% block content %}

<!-- PAGE HERO (keep as you have it translated already) -->
<section class="page-hero d-flex align-items-center">
  <div class="page-hero-overlay"></div>
  <div class="container position-relative">
    <div class="row">
      <div class="col-lg-8">
        <div class="page-hero-content reveal-on-scroll">
          <p class="section-label mb-2">
            <span class="section-text">intro</span>
          </p>
          <h1 class="h2 h1-lg fw-semibold mb-3">
            <span class="section-text">appointment_title</span>
          </h1>
          <p class="text-muted mb-0">
            <span class="section-text">note</span>
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- BOOKING FORM SECTION -->
<section class="py-5 section-soft">
  <div class="container">
    <div class="row g-4 align-items-start booking-layout">
      {% set form = request.form %}

      <!-- FORM COLUMN -->
      <div class="col-lg-7">
        <div class="booking-card p-4 p-lg-5 reveal-on-scroll">
          <h2 class="h4 fw-semibold mb-3">
            <span class="appointment-text">appointment_form_title</span>
          </h2>
          <p class="text-muted small mb-4">
            <span class="appointment-text">appointment_form_subtitle</span>
          </p>

          <form
            method="POST"
            action="{{ url_for('appointment', lang=lang) }}"
            novalidate
            autocomplete="on"
          >
            {# If you use Flask-WTF, you can add: {{ form.hidden_tag() }} #}

            <div class="row g-3">
              <!-- Full name (backend: name) -->
              <div class="col-md-6">
                <label for="name" class="form-label tiny text-uppercase letter-spacing-wide">
                  <span class="form-text">appointment_label_name</span>
                </label>
                <input
                  type="text"
                  class="form-control"
                  id="name"
                  name="name"
                  required
                  aria-required="true"
                  autocomplete="name"
                  value="{{ form.get('name', '') }}"
                  placeholder=""
                >
              </div>

              <!-- Email (backend: email) -->
              <div class="col-md-6">
                <label for="email" class="form-label tiny text-uppercase letter-spacing-wide">
                  <span class="form-text">appointment_label_email</span>
                </label>
                <input
                  type="email"
                  class="form-control"
                  id="email"
                  name="email"
                  required
                  aria-required="true"
                  autocomplete="email"
                  value="{{ form.get('email', '') }}"
                  placeholder=""
                >
              </div>

              <!-- Phone (backend: phone) -->
              <div class="col-md-6">
                <label for="phone" class="form-label tiny text-uppercase letter-spacing-wide">
                  <span class="form-text">appointment_label_phone</span>
                </label>
                <input
                  type="tel"
                  class="form-control"
                  id="phone"
                  name="phone"
                  required
                  aria-required="true"
                  autocomplete="tel"
                  value="{{ form.get('phone', '') }}"
                  placeholder=""
                >
              </div>

              <!-- Date (backend: date) -->
              <div class="col-md-3">
                <label for="date" class="form-label tiny text-uppercase letter-spacing-wide">
                  <span class="form-text">appointment_label_date</span>
                </label>
                <input
                  type="date"
                  class="form-control"
                  id="date"
                  name="date"
                  required
                  aria-required="true"
                  value="{{ form.get('date', '') }}"
                >
              </div>

              <!-- Time (backend: time) -->
              <div class="col-md-3">
                <label for="time" class="form-label tiny text-uppercase letter-spacing-wide">
                  <span class="form-text">appointment_label_time</span>
                </label>
                {% set selected_time = form.get('time', '') %}
                <select
                  class="form-select"
                  id="time"
                  name="time"
                  required
                  aria-required="true"
                >
                  <option value="">{{ translations_placeholder if false else " " }}</option>
                  <option value="09:00" {{ 'selected' if selected_time == '09:00' else '' }}>09:00</option>
                  <option value="10:00" {{ 'selected' if selected_time == '10:00' else '' }}>10:00</option>
                  <option value="11:00" {{ 'selected' if selected_time == '11:00' else '' }}>11:00</option>
                  <option value="12:00" {{ 'selected' if selected_time == '12:00' else '' }}>12:00</option>
                  <option value="14:00" {{ 'selected' if selected_time == '14:00' else '' }}>14:00</option>
                  <option value="15:00" {{ 'selected' if selected_time == '15:00' else '' }}>15:00</option>
                  <option value="16:00" {{ 'selected' if selected_time == '16:00' else '' }}>16:00</option>
                  <option value="17:00" {{ 'selected' if selected_time == '17:00' else '' }}>17:00</option>
                  <option value="18:00" {{ 'selected' if selected_time == '18:00' else '' }}>18:00</option>
                </select>
              </div>

              <!-- Optional: Session type -->
              <div class="col-md-6">
                <label for="session_type" class="form-label tiny text-uppercase letter-spacing-wide">
                  <span class="form-text">appointment_label_session_type</span>
                </label>
                {% set selected_type = form.get('session_type', '') %}
                <select
                  class="form-select"
                  id="session_type"
                  name="session_type"
                >
                  <option value="" {{ 'selected' if not selected_type else '' }}>—</option>

                  <option value="online"
                          class="form-text"
                          {{ 'selected' if selected_type == 'online' else '' }}>
                    appointment_session_type_online
                  </option>

                  <option value="in_person"
                          class="form-text"
                          {{ 'selected' if selected_type == 'in_person' else '' }}>
                    appointment_session_type_in_person
                  </option>

                  <option value="hybrid"
                          class="form-text"
                          {{ 'selected' if selected_type == 'hybrid' else '' }}>
                    appointment_session_type_hybrid
                  </option>
                </select>

              </div>

              <!-- Optional: Topic -->
              <div class="col-md-6">
                <label for="topic" class="form-label tiny text-uppercase letter-spacing-wide">
                  <span class="form-text">appointment_label_topic</span>
                </label>
                {% set selected_topic = form.get('topic', '') %}
                <select
                  class="form-select"
                  id="topic"
                  name="topic"
                >
                  <option value="" {{ 'selected' if not selected_topic else '' }}>—</option>

                  <option value="stress"
                          class="form-text"
                          {{ 'selected' if selected_topic == 'stress' else '' }}>
                    appointment_topic_stress
                  </option>

                  <option value="relationships"
                          class="form-text"
                          {{ 'selected' if selected_topic == 'relationships' else '' }}>
                    appointment_topic_relationships
                  </option>

                  <option value="anxiety"
                          class="form-text"
                          {{ 'selected' if selected_topic == 'anxiety' else '' }}>
                    appointment_topic_anxiety
                  </option>

                  <option value="self_esteem"
                          class="form-text"
                          {{ 'selected' if selected_topic == 'self_esteem' else '' }}>
                    appointment_topic_self_esteem
                  </option>

                  <option value="other"
                          class="form-text"
                          {{ 'selected' if selected_topic == 'other' else '' }}>
                    appointment_topic_other
                  </option>
                </select>

              </div>

              <!-- Message (optional) -->
              <div class="col-12">
                <label for="message" class="form-label tiny text-uppercase letter-spacing-wide">
                  <span class="form-text">appointment_label_message</span>
                </label>
                <textarea
                  class="form-control"
                  id="message"
                  name="message"
                  rows="4"
                  placeholder=""
                >{{ form.get('message', '') }}</textarea>
              </div>

              <!-- Info note -->
              <div class="col-12">
                <div class="alert alert-info mt-2 tiny">
                  <i class="fas fa-info-circle me-2" aria-hidden="true"></i>
                  <span class="alert-text">appointment_info_note</span>
                </div>
              </div>

              <!-- Submit -->
              <div class="col-12 pt-2">
                <button
                  type="submit"
                  class="btn btn-primary btn-lg px-5 w-100"
                >
                  <i class="fas fa-calendar-check me-2" aria-hidden="true"></i>
                  <span class="btn-text">appointment_submit_text</span>
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>

      <!-- SIDE INFO PANEL -->
      <div class="col-lg-5">
        <div class="booking-info-card p-4 p-lg-5 reveal-on-scroll">
          <h3 class="h5 fw-semibold mb-3">
            <span class="section-text">appointment_info_title</span>
          </h3>

          <div class="mb-3">
            <p class="fw-semibold mb-1 small text-uppercase letter-spacing-wide">
              <span class="section-text">appointment_info_availability_label</span>
            </p>
            <p class="mb-0 text-muted tiny">
              <span class="section-text">appointment_info_availability_text</span>
            </p>
          </div>

          <div class="mb-3">
            <p class="fw-semibold mb-1 small text-uppercase letter-spacing-wide">
              <span class="section-text">appointment_info_location_label</span>
            </p>
            <p class="mb-0 text-muted tiny">
              <span class="section-text">appointment_info_location_text</span>
            </p>
          </div>

          <div class="mb-3">
            <p class="fw-semibold mb-1 small text-uppercase letter-spacing-wide">
              <span class="section-text">appointment_info_languages_label</span>
            </p>
            <p class="mb-0 text-muted tiny">
              <span class="section-text">appointment_info_languages_text</span>
            </p>
          </div>

          <div class="booking-note mt-4 pt-3">
            <p class="tiny text-muted mb-1">
              <span class="section-text">appointment_info_please_note_label</span>
            </p>
            <p class="mb-0 tiny text-muted">
              <span class="section-text">appointment_info_please_note_text</span>
            </p>
          </div>
        </div>
      </div>

    </div>
  </div>
</section>

<!-- Min date script (tomorrow onwards) -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const dateInput = document.getElementById('date');
    if (dateInput && !dateInput.value) {
      const today = new Date();
      today.setDate(today.getDate() + 1); // tomorrow
      const tomorrow = today.toISOString().split('T')[0];
      dateInput.setAttribute('min', tomorrow);
    }
  });
</script>

{% endblock %}
